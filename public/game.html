<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="shortcut icon" href="">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/css/bootstrap.min.css" />
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
        <script type="text/javascript">
            
            // Handle Socket / Chat functions

            const socket = io.connect();
            const name = localStorage.getItem("name");
            if (socket != undefined) {
                console.log("Connected: " + name);
            }

            // Replace image URL
            socket.on('image', function(objectdata) {
                $('#picture').attr('src', objectdata.url);
            });

            // Receive message
            socket.on('message', function(objectdata) {
                console.log("received msg");
                console.log(objectdata);
                $('#chat')
                    .prepend(objectdata.name + ': ' + objectdata.message + '\n');
            });
            
            console.log(https://en.wikipedia.org/w/api.php?action=opensearch&search=arc_de_triomphe&limit=1&format=json);

		</script>
		<style>
			
		</style>
	</head>
	<body>
		<div class="container-fluid rounded shadow-sm p-3 mb-5">
			<div class="row">
				<div class="col-md-10" style="background-color: grey; padding: 20px">
                    <!-- google api picture display -->
                    <img id="picture" src="">
                </div>
                <div class="col-md-2" style="background-color: greenyellow;">
                    <!-- high score or connection window with points?
                         convert to table? -->
                    <p>
                        Nelson:  100 <br>
                        Nick:     50 <br>
                        Cat:       1 <br>
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6" style="background-color: green; height:200px; max-height: 200px; overflow-y:auto;">
                    <pre id="chat" style="white-space: pre-wrap;"></pre>
                </div>
                <div class="col-md-6" style="background-color: blue;">
                    Hint Window
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" style="margin-top: 8px;">
                    <input id="message" type="text" size= "86" placeholder="Message" autocomplete="off">
                    <input id="send" type="button" value="submit"> 
                </div>
            </div>

            <script type='text/javascript'>
                $('#send').on('click', function() {
                    socket.emit('message', {
                        'name': name,
                        'message': $('#message').val()
                    });
                    $('#message').val('');
                });

                $('#message').on('keypress', function(event) {
                    if (event.which == 13) {
                        socket.emit('message', {
                            'name': name,
                            'message': $('#message').val()
                        });
                        $('#message').val('');
                    }
                });
            </script>
        </div>
	</body>
</html>